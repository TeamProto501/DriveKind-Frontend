import{d as Vt,f as pt,s as r,a as nt}from"../chunks/BOZPY13N.js";import{p as Wt,a as Xt,f as Zt,c as e,s as a,r as t,n as te,g as s,u as Pt,t as ct,d as y,b as n}from"../chunks/4aDsAy4W.js";import{i as ee}from"../chunks/BVWxLK3S.js";import{e as ae,i as se}from"../chunks/B4vlcJ1Q.js";import{c as re}from"../chunks/CFFr90Hq.js";import{r as ie,s as Ft,b as vt}from"../chunks/Cnk5pdOU.js";import{b as oe}from"../chunks/CRyBVsus.js";import{R as le,B as de,S as ne}from"../chunks/BYRPlxIn.js";import{S as ce}from"../chunks/GrRlbfhQ.js";import{D as ve}from"../chunks/C6hekGxW.js";import{C as pe}from"../chunks/BX0fC89f.js";import{E as ue}from"../chunks/B450Nzlp.js";import{F as jt}from"../chunks/BhoO6PyP.js";import{S as me}from"../chunks/C-pBdbtF.js";import{D as xe}from"../chunks/D32DZshw.js";import{U as _e}from"../chunks/BTNOo6t_.js";function ge(){console.log("Exporting audit logs...")}function Bt(z,h,w){n(h,!1),n(w,null)}var fe=(z,h,w)=>h(s(w)),be=pt('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"><div class="flex items-center"><!> </div></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"><span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"> </span></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"><div class="flex items-center"><!> </div></td><td class="px-6 py-4 text-sm text-gray-900 max-w-xs truncate"> </td><td class="px-6 py-4 whitespace-nowrap"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium"><button class="text-blue-600 hover:text-blue-900 transition-colors"><!></button></td></tr>'),ye=pt('<div class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"><div class="relative top-20 mx-auto p-5 border w-2xl shadow-lg rounded-md bg-white"><div class="mt-3"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-medium text-gray-900">Audit Log Details</h3> <button class="text-gray-400 hover:text-gray-600 transition-colors"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="space-y-4"><div class="grid grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-700">Log ID</label> <p class="mt-1 text-sm text-gray-900"> </p></div> <div><label class="block text-sm font-medium text-gray-700">Timestamp</label> <p class="mt-1 text-sm text-gray-900"> </p></div> <div><label class="block text-sm font-medium text-gray-700">User</label> <p class="mt-1 text-sm text-gray-900"> </p></div> <div><label class="block text-sm font-medium text-gray-700">IP Address</label> <p class="mt-1 text-sm text-gray-900"> </p></div> <div><label class="block text-sm font-medium text-gray-700">Action</label> <p class="mt-1 text-sm text-gray-900"> </p></div> <div><label class="block text-sm font-medium text-gray-700">Resource</label> <p class="mt-1 text-sm text-gray-900"> </p></div> <div><label class="block text-sm font-medium text-gray-700">Status</label> <span> </span></div></div> <div><label class="block text-sm font-medium text-gray-700">Details</label> <p class="mt-1 text-sm text-gray-900 bg-gray-50 p-3 rounded-md"> </p></div></div> <div class="mt-6 flex justify-end"><button class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md text-sm font-medium hover:bg-gray-400 transition-colors">Close</button></div></div></div></div>'),he=pt('<div class="min-h-screen bg-gray-50"><!> <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="mb-8"><h1 class="text-3xl font-bold text-gray-900">Audit Logs</h1> <p class="text-gray-600 mt-2">Monitor system activity and security events.</p></div> <div class="bg-white shadow rounded-lg p-6 mb-6"><div class="flex flex-col sm:flex-row gap-4"><div class="flex-1"><div class="relative"><!> <input type="text" placeholder="Search logs..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div></div> <div class="flex gap-2"><select class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option>All Resources</option><option>Authentication</option><option>User Management</option><option>Trip Management</option><option>Database</option><option>System</option></select> <select class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option>All Status</option><option>Success</option><option>Failed</option></select> <select class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option>Last 24 Hours</option><option>Last 7 Days</option><option>Last 30 Days</option><option>Last 90 Days</option></select> <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2"><!> <span>Export</span></button></div></div></div> <div class="bg-white shadow rounded-lg overflow-hidden"><div class="px-6 py-4 border-b border-gray-200"><div class="flex items-center justify-between"><h2 class="text-lg font-medium text-gray-900">Activity Logs</h2> <span class="text-sm text-gray-500"> </span></div></div> <div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timestamp</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Resource</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Details</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div></div></div></div> <!>',1);function je(z,h){Wt(h,!0);const w=[{id:1,timestamp:"2024-01-15 14:30:22",user:"admin@drivekind.com",action:"LOGIN",resource:"AUTH",details:"User logged in successfully",ipAddress:"192.168.1.100",status:"SUCCESS"},{id:2,timestamp:"2024-01-15 14:25:15",user:"admin@drivekind.com",action:"UPDATE",resource:"USER",details:"Updated user profile: john.doe@drivekind.com",ipAddress:"192.168.1.100",status:"SUCCESS"},{id:3,timestamp:"2024-01-15 14:20:08",user:"dispatcher@drivekind.com",action:"CREATE",resource:"TRIP",details:"Created new trip request #TR-2024-001",ipAddress:"192.168.1.101",status:"SUCCESS"},{id:4,timestamp:"2024-01-15 14:15:42",user:"driver@drivekind.com",action:"UPDATE",resource:"TRIP",details:"Updated trip status to IN_PROGRESS",ipAddress:"192.168.1.102",status:"SUCCESS"},{id:5,timestamp:"2024-01-15 14:10:30",user:"unknown",action:"LOGIN",resource:"AUTH",details:"Failed login attempt for invalid user",ipAddress:"192.168.1.103",status:"FAILED"}];let x=y(""),R=y("all"),D=y("all"),ut=y("24h"),T=y(!1),i=y(null),mt=Pt(()=>w.filter(o=>{const _t=!s(x)||o.user.toLowerCase().includes(s(x).toLowerCase())||o.action.toLowerCase().includes(s(x).toLowerCase())||o.details.toLowerCase().includes(s(x).toLowerCase()),I=s(R)==="all"||o.resource===s(R),S=s(D)==="all"||o.status===s(D);return _t&&I&&S}));function Ht(o){switch(o){case"AUTH":return ne;case"USER":return _e;case"TRIP":return jt;case"DATABASE":return xe;case"SYSTEM":return me;default:return jt}}function xt(o){return o==="SUCCESS"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}function Gt(o){n(i,o,!0),n(T,!0)}le(z,{requiredRoles:["Admin"],children:(o,_t)=>{var I=he(),S=Zt(I),gt=e(S);de(gt,{});var ft=a(gt,2),Q=a(e(ft),2),bt=e(Q),J=e(bt),yt=e(J),ht=e(yt);ce(ht,{class:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"});var wt=a(ht,2);ie(wt),t(yt),t(J);var St=a(J,2),$=e(St),K=e($);K.value=K.__value="all";var V=a(K);V.value=V.__value="AUTH";var W=a(V);W.value=W.__value="USER";var X=a(W);X.value=X.__value="TRIP";var Z=a(X);Z.value=Z.__value="DATABASE";var kt=a(Z);kt.value=kt.__value="SYSTEM",t($);var M=a($,2),tt=e(M);tt.value=tt.__value="all";var et=a(tt);et.value=et.__value="SUCCESS";var At=a(et);At.value=At.__value="FAILED",t(M);var P=a(M,2),at=e(P);at.value=at.__value="24h";var st=a(at);st.value=st.__value="7d";var rt=a(st);rt.value=rt.__value="30d";var Ct=a(rt);Ct.value=Ct.__value="90d",t(P);var it=a(P,2);it.__click=[ge];var Nt=e(it);ve(Nt,{class:"w-4 h-4"}),te(2),t(it),t(St),t(bt),t(Q);var Et=a(Q,2),ot=e(Et),Lt=e(ot),Ut=a(e(Lt),2),Ot=e(Ut);t(Ut),t(Lt),t(ot);var Rt=a(ot,2),Dt=e(Rt),Tt=a(e(Dt));ae(Tt,21,()=>s(mt),se,(l,d)=>{const F=Pt(()=>Ht(s(d).resource));var _=be(),c=e(_),j=e(c),g=e(j);pe(g,{class:"w-4 h-4 text-gray-400 mr-2"});var k=a(g);t(j),t(c);var v=a(c),B=e(v,!0);t(v);var A=a(v),f=e(A),H=e(f,!0);t(f),t(A);var C=a(A),b=e(C),E=e(b);re(E,()=>s(F),(U,Y)=>{Y(U,{class:"w-4 h-4 text-gray-600 mr-2"})});var lt=a(E);t(b),t(C);var p=a(C),G=e(p,!0);t(p);var L=a(p),u=e(L),N=e(u,!0);t(u),t(L);var O=a(L),m=e(O);m.__click=[fe,Gt,d];var q=e(m);ue(q,{class:"w-4 h-4"}),t(m),t(O),t(_),ct(U=>{r(k,` ${s(d).timestamp??""}`),r(B,s(d).user),r(H,s(d).action),r(lt,` ${s(d).resource??""}`),r(G,s(d).details),Ft(u,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${U??""}`),r(N,s(d).status)},[()=>xt(s(d).status)]),nt(l,_)}),t(Tt),t(Dt),t(Rt),t(Et),t(ft),t(S);var qt=a(S,2);{var Yt=l=>{var d=ye(),F=e(d),_=e(F),c=e(_),j=a(e(c),2);j.__click=[Bt,T,i],t(c);var g=a(c,2),k=e(g),v=e(k),B=a(e(v),2),A=e(B);t(B),t(v);var f=a(v,2),H=a(e(f),2),C=e(H,!0);t(H),t(f);var b=a(f,2),E=a(e(b),2),lt=e(E,!0);t(E),t(b);var p=a(b,2),G=a(e(p),2),L=e(G,!0);t(G),t(p);var u=a(p,2),N=a(e(u),2),O=e(N,!0);t(N),t(u);var m=a(u,2),q=a(e(m),2),U=e(q,!0);t(q),t(m);var Y=a(m,2),dt=a(e(Y),2),zt=e(dt,!0);t(dt),t(Y),t(k);var It=a(k,2),$t=a(e(It),2),Qt=e($t,!0);t($t),t(It),t(g);var Mt=a(g,2),Jt=e(Mt);Jt.__click=[Bt,T,i],t(Mt),t(_),t(F),t(d),ct(Kt=>{r(A,`#${s(i).id??""}`),r(C,s(i).timestamp),r(lt,s(i).user),r(L,s(i).ipAddress),r(O,s(i).action),r(U,s(i).resource),Ft(dt,1,`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Kt??""}`),r(zt,s(i).status),r(Qt,s(i).details)},[()=>xt(s(i).status)]),nt(l,d)};ee(qt,l=>{s(T)&&s(i)&&l(Yt)})}ct(()=>r(Ot,`${s(mt).length??""} entries`)),oe(wt,()=>s(x),l=>n(x,l)),vt($,()=>s(R),l=>n(R,l)),vt(M,()=>s(D),l=>n(D,l)),vt(P,()=>s(ut),l=>n(ut,l)),nt(o,I)},$$slots:{default:!0}}),Xt()}Vt(["click"]);export{je as component};
